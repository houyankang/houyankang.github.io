<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content=#58b77a>
  <title>Docker | Yan&#39;s Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Yan">
  <meta name="keywords" content="Java��Html��CSS��JavaScript�ȱ�̾�������������ܽᡢ�ĵ����">
  <meta name="description" content="Java��Html��CSS��JavaScript�ȱ�̾�������������ܽᡢ�ĵ����">
  <script id="hexo-configurations">
  var CONFIG = {
    root: '/',
    theme: 'lx',
    version: '0.3.9',
    localsearch:{
      "enable": true,
      "trigger": "auto",
      "top_n_per_article": 1,
      "unescape": false,
      "preload": false
      },
    path: 'search.xml'
  };
</script>

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/main.min.css">
  <style type="text/css">
    pre,
    code {
      font-family: 'Fira Code', monospace;
    }
    html {
      font-family: sans-serif;
    }
    body {
      font-family: sans-serif;
    }
    h1, h2, h3, h4, h5, figure {
      font-family: sans-serif;
    }
    .menu-container{
      font-family: sans-serif;
    }
  </style>

  <script src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/js/jquery.jside.menu.js"></script>
	<script>
	$(document).ready(function(){
	$(".menu-container").jSideMenu({
	    jSidePosition: "position-right",
	    jSideSticky: true,
	    jSideSkin: "greenish",
	     });
	}); 
	</script>
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Fira Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">
<meta name="generator" content="Hexo 5.0.2"></head>
<body>
<div class="single">
<a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i></a>
<div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Search..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>

<div id="page">
<div id="lx-aside" style="background-image: url(//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/images/post_cover.jpeg)" data-stellar-background-ratio="0.5">
  <div class="overlay">
  <div class="page-title">
    <div class="avatar"><a href="/"><img src="/images/avatar.jpeg"></a></div>
    <span>2020-08-15</span>
    <h2>Docker</h2>
    
    <div class="social-links">
    <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1337485110&amp;site=qq&amp;menu=yes" target="_blank"><i class="fa fa-qq fa-fw"></i></a>
</div></div>
</div>
</div>

<div id="lx-main-content">
  <div class="lx-post">
    <div class="lx-entry padding">
      <div>
        <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><a id="more"></a>

<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711095921218.png" alt="image-20200711095921218"></p>
<h3 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h3><hr>
<h4 id="1-1、环境不一致"><a href="#1-1、环境不一致" class="headerlink" title="1.1、环境不一致"></a>1.1、环境不一致</h4><blockquote>
<p>我本地运行没问题：由于环境不一致，导致相同的程序，运行结果不一致</p>
</blockquote>
<h4 id="1-2、隔离性"><a href="#1-2、隔离性" class="headerlink" title="1.2、隔离性"></a>1.2、隔离性</h4><blockquote>
<p>在多用户的操作系统下，会因为其他用户的操作失误影响到你自己编写的程序</p>
</blockquote>
<h4 id="1-3、弹性伸缩"><a href="#1-3、弹性伸缩" class="headerlink" title="1.3、弹性伸缩"></a>1.3、弹性伸缩</h4><blockquote>
<p>淘宝在双11的时候，用户量暴增，需要很多很多的运维人员去增加部署服务器，导致运维成本过高的问题。</p>
</blockquote>
<h4 id="1-4、学习成本"><a href="#1-4、学习成本" class="headerlink" title="1.4、学习成本"></a>1.4、学习成本</h4><blockquote>
<p>学习一门技术，得先安装，学习每一门技术都需要先安装相应的软件，但是还有他所依赖的各种环境，安装软件的成本快高过学习成本了。</p>
</blockquote>
<h3 id="二、Docker介绍"><a href="#二、Docker介绍" class="headerlink" title="二、Docker介绍"></a>二、Docker介绍</h3><hr>
<h4 id="2-1、Docker的由来"><a href="#2-1、Docker的由来" class="headerlink" title="2.1、Docker的由来"></a>2.1、Docker的由来</h4><blockquote>
<p>一帮年轻人创业，创办了一家公司，2010年专门做PASS平台，但是到了2013年多的时候，像亚马逊、微软、Google都开始做PASS平台，到了2013年，公司资金流断裂，不得不倒闭，于是将公司内的核心技术对外开源，核心技术就是Docker，到了2014年的时候，得到了C轮的融资4000W，2015年的时候，得到了D轮融资9500W，于是公司开始全神贯注的维护Docker。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Docker主要作者-所罗门</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711101555703.png" alt="image-20200711101555703"></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">Docker的作者已经离开了维护Docker的团队</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711101749447.png" alt="image-20200711101749447"></td>
</tr>
</tbody></table>
<h4 id="2-2、Docker的思想"><a href="#2-2、Docker的思想" class="headerlink" title="2.2、Docker的思想"></a>2.2、Docker的思想</h4><blockquote>
<ul>
<li>集装箱：会将所有需要的内容放到不同的集装箱中，谁需要这些环境就直接拿到这个集装箱就可以了。</li>
<li>标准化：<ul>
<li>运输的标准化: Docker有一 个码头，所有上传的集装箱都放在了这个码头上，当谁需要某一个环境，就直接指派大海豚去搬运这个集装箱就可以了。</li>
<li>命令的标准化: Docker提供了一些列的命令，帮助我们去获取集装箱等等操作。</li>
<li>提供了REST的API : 衍生出了很多的图形化界面，Rancher。</li>
</ul>
</li>
<li>隔离性: Docker在运行集装箱内的内容时，会在Linux的内核中， 单独的开辟一 片空间，这片空间不会影响到其他程序。</li>
<li>中央仓库|注册中心:超级码头，上面放的就是集装箱</li>
<li>镜像:就是集装箱</li>
<li>容器:运行起来的镜像</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Docker</th>
<th align="center">Java</th>
</tr>
</thead>
<tbody><tr>
<td align="center">镜像</td>
<td align="center">类</td>
</tr>
<tr>
<td align="center">容器</td>
<td align="center">对象</td>
</tr>
</tbody></table>
<h3 id="三、Docker的安装"><a href="#三、Docker的安装" class="headerlink" title="三、Docker的安装"></a>三、Docker的安装</h3><hr>
<h4 id="3-1、下载Docker依赖的环境"><a href="#3-1、下载Docker依赖的环境" class="headerlink" title="3.1、下载Docker依赖的环境"></a>3.1、下载Docker依赖的环境</h4><blockquote>
<p>想安装Docker，需要先将依赖的环境全部下载，就像Maven依赖JDK一样</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>

<h4 id="3-2、指定Docker的镜像源"><a href="#3-2、指定Docker的镜像源" class="headerlink" title="3.2、指定Docker的镜像源"></a>3.2、指定Docker的镜像源</h4><blockquote>
<p>默认下载Docker会去国外服务器下载，速度较慢，我们可以设置为阿里云镜像，速度更快</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;docker-ce&#x2F;linux&#x2F;centos&#x2F;docker-ce.repo</span><br></pre></td></tr></table></figure>

<h4 id="3-3、安装Docker"><a href="#3-3、安装Docker" class="headerlink" title="3.3、安装Docker"></a>3.3、安装Docker</h4><blockquote>
<p>依然采用yum的方式安装</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure>

<h4 id="3-4、启动Docker并测试"><a href="#3-4、启动Docker并测试" class="headerlink" title="3.4、启动Docker并测试"></a>3.4、启动Docker并测试</h4><blockquote>
<p>安装成功后，需要手动启动，设置为开机自启，并测试一下Docker</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动Docker服务</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="comment"># 设置开机自动启动</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> hello-world</span></span><br></pre></td></tr></table></figure>

<h3 id="四、Docker的中央仓库【重点】"><a href="#四、Docker的中央仓库【重点】" class="headerlink" title="四、Docker的中央仓库【重点】"></a>四、Docker的中央仓库【<code>重点</code>】</h3><hr>
<blockquote>
<ul>
<li>Docker官方的中央仓库:这个仓库是镜像最全的，但是下载速度较慢。<ul>
<li><a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></li>
</ul>
</li>
<li>国内的镜像网站:网易蜂巢，daoCloud等，下载速度快， 但是镜像相对不全。<ul>
<li><a target="_blank" rel="noopener" href="https://c.163yun.com/hub#/home">https://c.163yun.com/hub#/home</a></li>
<li><a target="_blank" rel="noopener" href="http://hub.daocloud.io/">http://hub.daocloud.io/</a> (<code>推荐 使用</code>)</li>
</ul>
</li>
<li>在公司内部会采用私服的方式拉取镜像，需要添加配置，如下…..</li>
</ul>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  需要创建/etc/docker/daemon.json,并添加以下内容</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;registry-mirrors&quot;</span>:[<span class="string">&quot;https://registry. docker-cn. com&quot;</span>],</span><br><span class="line">    <span class="string">&quot;insecure-registries&quot;</span>:[<span class="string">&quot;ip:port&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启两个服务</span></span><br><span class="line">systemctl daemon- reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<h3 id="五、镜像的操作【重点】"><a href="#五、镜像的操作【重点】" class="headerlink" title="五、镜像的操作【重点】"></a>五、镜像的操作【<code>重点</code>】</h3><hr>
<h4 id="5-1、拉取镜像"><a href="#5-1、拉取镜像" class="headerlink" title="5.1、拉取镜像"></a>5.1、拉取镜像</h4><blockquote>
<p>从<a target="_blank" rel="noopener" href="http://hub.daocloud.io/%E4%BB%93%E5%BA%93%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F%E5%88%B0%E6%9C%AC%E5%9C%B0">http://hub.daocloud.io/仓库拉取镜像到本地</a></p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull 镜像名称[:tag]</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker pull daocloud.io/library/tomcat:8.5.15-jre8</span></span><br></pre></td></tr></table></figure>

<h4 id="5-2、查看本地全部镜像"><a href="#5-2、查看本地全部镜像" class="headerlink" title="5.2、查看本地全部镜像"></a>5.2、查看本地全部镜像</h4><blockquote>
<p>查看本地已经安装过的镜像信息，包含标识，名称，版本，更新时间，大小</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<h4 id="5-3、删除本地镜像"><a href="#5-3、删除本地镜像" class="headerlink" title="5.3、删除本地镜像"></a>5.3、删除本地镜像</h4><blockquote>
<p>镜像会占用磁盘空间，可以直接手动删除，表示通过查看获取</p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711110239567.png" alt="image-20200711110239567"></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker rmi 镜像的标识</span></span><br></pre></td></tr></table></figure>

<h4 id="5-4、镜像的导入导出"><a href="#5-4、镜像的导入导出" class="headerlink" title="5.4、镜像的导入导出"></a>5.4、镜像的导入导出</h4><blockquote>
<p>如果因为网络原因可以通过硬盘方式传输镜像，虽然不规范，但是有效，但是这种方式导出的镜像名称和版本都是null，需要手动修改。</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将本地的镜像导出</span></span><br><span class="line">docker save -o 导出的路径 镜像id</span><br><span class="line"><span class="comment"># 加载本地的镜像文件</span></span><br><span class="line">docker load -i 镜像文件</span><br><span class="line"><span class="comment"># 修改镜像名称</span></span><br><span class="line">docker tag 镜像id 新镜像名称：版本</span><br></pre></td></tr></table></figure>

<h3 id="六、容器操作【重点】"><a href="#六、容器操作【重点】" class="headerlink" title="六、容器操作【重点】"></a>六、容器操作【<code>重点</code>】</h3><hr>
<h4 id="6-1、容器运行"><a href="#6-1、容器运行" class="headerlink" title="6.1、容器运行"></a>6.1、容器运行</h4><blockquote>
<p>运行容器需要指定具体的镜像，如果镜像不存在，会直接下载</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单操作</span></span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> 镜像的标识|镜像名称[:tag]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用的参数</span></span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> -d -q 宿主机端口：容器端口 --name 容器名称 镜像的标识</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -d:代表后台运行容器</span></span><br><span class="line"><span class="comment"># -p 宿主机端口：容器端口： 为了映射当前Linux的端口和容器的端口</span></span><br><span class="line"><span class="comment"># --name 容器名称：指定容器的名称</span></span><br></pre></td></tr></table></figure>

<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711113932284.png" alt="image-20200711113932284"></p>
<h4 id="6-2、查看正在运行的容器"><a href="#6-2、查看正在运行的容器" class="headerlink" title="6.2、查看正在运行的容器"></a>6.2、查看正在运行的容器</h4><blockquote>
<p>查看全部正在运行的容器</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker ps [-qa]</span><br><span class="line"><span class="comment"># -a:查看全部的容器，包括没有运行</span></span><br><span class="line"><span class="comment"># -q：只查看容器的表示</span></span><br></pre></td></tr></table></figure>

<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711142759368.png" alt="image-20200711142759368"></p>
<h4 id="6-3、查看容器日志"><a href="#6-3、查看容器日志" class="headerlink" title="6.3、查看容器日志"></a>6.3、查看容器日志</h4><blockquote>
<p>查看容器日志，以查看容器运行的信息</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f 容器id</span><br><span class="line"><span class="comment"># -f：可以滚动查看日志的最后几行</span></span><br></pre></td></tr></table></figure>

<h4 id="6-4、进入容器内部"><a href="#6-4、进入容器内部" class="headerlink" title="6.4、进入容器内部"></a>6.4、进入容器内部</h4><blockquote>
<p>可以进入到容器内部进行操作</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器id bash</span><br></pre></td></tr></table></figure>

<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711143500253.png" alt="image-20200711143500253"></p>
<h4 id="6-5、复制内容到容器"><a href="#6-5、复制内容到容器" class="headerlink" title="6.5、复制内容到容器"></a>6.5、复制内容到容器</h4><blockquote>
<p>将宿主机的文件复制到容器内部的指定目录</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 文件名称 容器id：容器内部路径</span><br></pre></td></tr></table></figure>

<h4 id="6-6、重启-amp-启动-amp-停止-amp-删除容器"><a href="#6-6、重启-amp-启动-amp-停止-amp-删除容器" class="headerlink" title="6.6、重启&amp;启动&amp;停止&amp;删除容器"></a>6.6、重启&amp;启动&amp;停止&amp;删除容器</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重新启动容器</span></span><br><span class="line">docker restart 容器id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动停止运行的容器</span></span><br><span class="line">docker start 容器id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止指定的容器（删除容器前，需要先停止容器）</span></span><br><span class="line">docker stop 容器id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止全部容器</span></span><br><span class="line">docker stop $(docker ps -qa)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定容器</span></span><br><span class="line">docker rm 容器id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除全部容器</span></span><br><span class="line">docker rm $(docker ps -qa)</span><br></pre></td></tr></table></figure>

<h3 id="七、Docker应用"><a href="#七、Docker应用" class="headerlink" title="七、Docker应用"></a>七、Docker应用</h3><hr>
<h4 id="7-1、安装lrzsz"><a href="#7-1、安装lrzsz" class="headerlink" title="7.1、安装lrzsz"></a>7.1、安装lrzsz</h4><blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install lrzsz</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="7-2、Docker安装Tomcat"><a href="#7-2、Docker安装Tomcat" class="headerlink" title="7.2、Docker安装Tomcat"></a>7.2、Docker安装Tomcat</h4><blockquote>
<p>运行Tomcat容器，为部署SSM工程做准备</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:8080 --name tomcat daocloud.io&#x2F;library&#x2F;tomcat:8.5.15-jre8 </span><br></pre></td></tr></table></figure>

<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711144619181.png" alt="image-20200711144619181"></p>
<blockquote>
<p>设置映射路径：将/usr/local/tomcat/webapps映射到/root/war</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:8080 -v &#x2F;root&#x2F;war:&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps --name tomcat tomcat:9.0</span><br></pre></td></tr></table></figure>



<h4 id="7-3、Docker安装MySql"><a href="#7-3、Docker安装MySql" class="headerlink" title="7.3、Docker安装MySql"></a>7.3、Docker安装MySql</h4><blockquote>
<p>运行MySql容器，为部署SSM工程做准备</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD&#x3D;root daocloud.io&#x2F;library&#x2F;mysql:5.7.4</span><br></pre></td></tr></table></figure>

<h4 id="7-4、Docker安装redis"><a href="#7-4、Docker安装redis" class="headerlink" title="7.4、Docker安装redis"></a>7.4、Docker安装redis</h4><blockquote>
<p>下载完镜像，在 docker/redis/目录下添加redis.config文件</p>
<p>然后运行以下代码</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 6379:6379 --name redis -v &#x2F;docker&#x2F;redis&#x2F;redis.conf:&#x2F;etc&#x2F;redis&#x2F;redis.conf -v &#x2F;usr&#x2F;local&#x2F;docker&#x2F;data:&#x2F;data -d redis:5.0.4 redis-server &#x2F;etc&#x2F;redis&#x2F;redis.conf --appendonly yes --requirepass &quot;1234&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>最后进入容器查看是否启动</p>
</blockquote>
<h4 id="7-5、部署SSM工程"><a href="#7-5、部署SSM工程" class="headerlink" title="7.5、部署SSM工程"></a>7.5、部署SSM工程</h4><blockquote>
<ul>
<li>修改SSM工程环境，设置为Linux中Docker容器的信息</li>
<li>通过Maven的package重 新打成war包</li>
<li>将Windows 下的war包复制到Linux中</li>
<li>通过docker命 令将宿主机的war包复制到容器内部</li>
<li>测试访问SSM工程</li>
</ul>
</blockquote>
<h3 id="八、数据卷【重点】"><a href="#八、数据卷【重点】" class="headerlink" title="八、数据卷【重点】"></a>八、数据卷【<code>重点</code>】</h3><hr>
<blockquote>
<p>为了部署SSM的工程，需要使用到cp的命令将宿主机内的ssm.war文件复制到容器内部。</p>
<p>数据卷:将宿主机的一个目录映射到容器的一个目录中。</p>
<p>可以在宿主机中操作目录中的内容，那么容器内部映射的文件，也会跟着一起改变。</p>
</blockquote>
<h4 id="8-1、创建数据卷"><a href="#8-1、创建数据卷" class="headerlink" title="8.1、创建数据卷"></a>8.1、创建数据卷</h4><blockquote>
<p>创建数据卷之后，默认会存放在一个目录下/var/lib/docker/volumes/数据卷名称/_data</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume create 数据卷名称</span><br></pre></td></tr></table></figure>

<h4 id="8-2、查看数据卷详情"><a href="#8-2、查看数据卷详情" class="headerlink" title="8.2、查看数据卷详情"></a>8.2、查看数据卷详情</h4><blockquote>
<p>查看数据卷的详细信息，可以查询到存放路径、创建时间等</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume inspect 数据卷名称</span><br></pre></td></tr></table></figure>

<h4 id="8-3、查看全部数据卷"><a href="#8-3、查看全部数据卷" class="headerlink" title="8.3、查看全部数据卷"></a>8.3、查看全部数据卷</h4><blockquote>
<p>查看全部数据卷信息</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume ls</span><br></pre></td></tr></table></figure>

<h4 id="8-4、删除数据卷"><a href="#8-4、删除数据卷" class="headerlink" title="8.4、删除数据卷"></a>8.4、删除数据卷</h4><blockquote>
<p>删除指定数据卷</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume rm 数据卷名称</span><br></pre></td></tr></table></figure>

<h4 id="8-5、容器映射数据卷"><a href="#8-5、容器映射数据卷" class="headerlink" title="8.5、容器映射数据卷"></a>8.5、容器映射数据卷</h4><blockquote>
<p>映射有两种方式：</p>
<ul>
<li>通过数据卷名称映射，如果数据卷不存在。Docker会 帮你自动创建，会将容器内部自带的文件，存储在默认的存放路径中。</li>
<li>通过路径映射数据卷，直接指定一个路径作为数据卷的存放位置。但是这个路径下是空的。</li>
</ul>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过数据卷名称映射</span></span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> -v 数据卷名称：容器内部的路径 镜像id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过路径映射数据卷</span></span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> -v 路径：容器内部的路径 镜像id</span></span><br></pre></td></tr></table></figure>

<h3 id="九、Dockerfile自定义镜像【重点】"><a href="#九、Dockerfile自定义镜像【重点】" class="headerlink" title="九、Dockerfile自定义镜像【重点】"></a>九、Dockerfile自定义镜像【<code>重点</code>】</h3><hr>
<blockquote>
<p>我们可以从中央仓库下载一个镜像，也可以自己手动去制作一个镜像， 需要通过Dockerfile去指定自定义镜像的信息。</p>
</blockquote>
<h4 id="9-1、Dockerfile"><a href="#9-1、Dockerfile" class="headerlink" title="9.1、Dockerfile"></a>9.1、Dockerfile</h4><blockquote>
<p>创建自定义镜像就需要创建一个Dockerfile, 如下为Dockerfile的语言：</p>
<ul>
<li>from:指定当前自定义镜像依赖的环境</li>
<li>copy:将相对路径下的内容复制到自定义镜像中</li>
<li>workdir:声明镜像的默认工作目录</li>
<li>run:执行的命令，可以编写多个</li>
<li>cmd:需要执行的命令(在workdir 下执行的，cmd可以写多个，只以最后一个为准)</li>
</ul>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#举个例子，制作SSM容器镜像，而且ssm. war要放在Dockerfile的同级目录下</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> daocloud .<span class="number">1</span>o/library/tomcat:<span class="number">8.5</span>. <span class="number">15</span>-jre8</span><br><span class="line"><span class="keyword">copy</span><span class="bash"> ssm . war /usr /<span class="built_in">local</span>/tomcat/ webapps</span></span><br></pre></td></tr></table></figure>

<h4 id="9-2、通过Dockerfile制作镜像"><a href="#9-2、通过Dockerfile制作镜像" class="headerlink" title="9.2、通过Dockerfile制作镜像"></a>9.2、通过Dockerfile制作镜像</h4><blockquote>
<p>编写完Dockerfile后需要通过命令将其制作为镜像，并且要在Dockerfile的当前目录下，之后即可在镜像中查看到指定的镜像信息，注意最后的<a href="">.</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 镜像名称[:tag] .</span><br></pre></td></tr></table></figure>

<h3 id="十、Docker-Compose"><a href="#十、Docker-Compose" class="headerlink" title="十、Docker-Compose"></a>十、Docker-Compose</h3><hr>
<blockquote>
<p>之前运行一个镜像，需要添加大量的参数，可以通过Docker-Compose编写这些参数。而且Docker-Compose可以帮助我们批量的管理容器。这些信息只需要通过一个docker-compose.yml文件去维护即可。</p>
</blockquote>
<h4 id="10-1、下载并安装Docker-Compose"><a href="#10-1、下载并安装Docker-Compose" class="headerlink" title="10.1、下载并安装Docker-Compose"></a>10.1、下载并安装Docker-Compose</h4><h5 id="10-1-1、下载Docker-Compose"><a href="#10-1-1、下载Docker-Compose" class="headerlink" title="10.1.1、下载Docker-Compose"></a>10.1.1、下载Docker-Compose</h5><blockquote>
<p>去github官网搜索docker-compose,下 载1.24.1版本的Docker Compose</p>
<p>下载路径: <a href="">https:/github.com/docker/compose/releases/download/1.24.1/docker-compose-Linux-x86_ 64</a></p>
</blockquote>
<h5 id="10-1-2、设置权限"><a href="#10-1-2、设置权限" class="headerlink" title="10.1.2、设置权限"></a>10.1.2、设置权限</h5><blockquote>
<p>需要将DockerCompose文件的名称修改一下， 给予DockerCompose文件- -个可执行的权限</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv docker- compose-L inux- x86.<span class="number">64</span> docker - compose</span><br><span class="line"></span><br><span class="line">chmod <span class="number">777</span> docker- compose</span><br></pre></td></tr></table></figure>

<h5 id="10-1-3、配置环境变量"><a href="#10-1-3、配置环境变量" class="headerlink" title="10.1.3、配置环境变量"></a>10.1.3、配置环境变量</h5><blockquote>
<p>方便后期操作，配置一个环境变量</p>
<p>将docker- compose文件移动到了/us/ocal/bin ,修改了/et/profile文件，给/usr/local/bin配置 到了PATH中</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mv docker-compose /usr /local/bin</span><br><span class="line"></span><br><span class="line">vi /etc/profile</span><br><span class="line"><span class="comment">#添加内容: export PATH=SJAVA. HOME : /usr/local/bin: SPATH</span></span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h5 id="10-1-4、测试"><a href="#10-1-4、测试" class="headerlink" title="10.1.4、测试"></a>10.1.4、测试</h5><blockquote>
<p>在任意目录下输入docker-compose</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">测试效果</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711152303577.png" alt="image-20200711152303577"></td>
</tr>
</tbody></table>
<h4 id="10-2、Docker-Compose管理MySql和Tomcat容器"><a href="#10-2、Docker-Compose管理MySql和Tomcat容器" class="headerlink" title="10.2、Docker-Compose管理MySql和Tomcat容器"></a>10.2、Docker-Compose管理MySql和Tomcat容器</h4><blockquote>
<p>yml文件以key: value方式来指定配置信息</p>
<p>多个配置信息以换行+缩进的方式来区分</p>
<p>在docke-compose.yml文件中，不要使用制表符</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line">services:</span><br><span class="line">    mysql:        <span class="comment">#服务的名称</span></span><br><span class="line">      restart: always    <span class="comment">#代表只要docker启动，那么这个容器就跟着-起启动</span></span><br><span class="line">      image: daocloud. io/library/mysql:<span class="number">5.7</span>.<span class="number">4</span>  <span class="comment">#指定镜像路径</span></span><br><span class="line">      container_ name: mysql <span class="comment"># 指定容器名称</span></span><br><span class="line">      ports:</span><br><span class="line">        -<span class="number">3306</span> :<span class="number">3306</span>  <span class="comment">#指定端口号的映射</span></span><br><span class="line">      environment :</span><br><span class="line">        MYSQL_ ROOT_PASSWORD: root <span class="comment"># 指定MySQL 的ROOT用户登录密码</span></span><br><span class="line">        TZ: Asia/ Shanghai <span class="comment">#指定时区</span></span><br><span class="line">      volumes :</span><br><span class="line">        -/opt/docker. mysql_ tomcat /mysq1 data:/var/lib/mysql</span><br><span class="line">    tomcat :</span><br><span class="line">      restart: always</span><br><span class="line">      image: daocloud . io/library/tomcat:<span class="number">8.5</span>.<span class="number">15</span>-jre8</span><br><span class="line">      container_name: tomcat</span><br><span class="line">      ports:</span><br><span class="line">        -<span class="number">8080</span> :<span class="number">8080</span></span><br><span class="line">      environment :</span><br><span class="line">        TZ: Asia/ Shanghai</span><br><span class="line">      volumes :</span><br><span class="line">        -/opt/docker_mysq1 _ tomcat/ tomcat. webapps : /usr/<span class="number">1</span>oca1/ tomcat /webapps </span><br><span class="line">      -/opt/docker . mysq1_ tomcat/ tomcat_ logs:/usr/<span class="number">1</span>oca1/ tomcat/<span class="number">1</span>ogs  </span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h4 id="10-3、使用docker-compose命令管理器"><a href="#10-3、使用docker-compose命令管理器" class="headerlink" title="10.3、使用docker-compose命令管理器"></a>10.3、使用docker-compose命令管理器</h4><blockquote>
<p>在使用docker-compose的命令时，默认会在当前目录下找docker-compose.yml文件</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.基于docker-compose . yml启动管理的容器</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.关闭并删除容器</span></span><br><span class="line">docker- compose down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.开启|关闭I重启已经存在的由docker- compose维护的容器</span></span><br><span class="line">docker-compose start | stop Irestart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.查看由docker- compose管理的容器</span></span><br><span class="line">docker-compose ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.查看日志</span></span><br><span class="line">docker-compose logs -f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="10-4、docker-compose配合Dockerfile使用"><a href="#10-4、docker-compose配合Dockerfile使用" class="headerlink" title="10.4、docker-compose配合Dockerfile使用"></a>10.4、docker-compose配合Dockerfile使用</h4><blockquote>
<p>使用docker-compose.yml文件以及Dockerfile文件在生成自定义镜像的同时启动当前镜像，并且由docker-compose去管理容器</p>
</blockquote>
<h5 id="10-4-1、docker-compose文件"><a href="#10-4-1、docker-compose文件" class="headerlink" title="10.4.1、docker-compose文件"></a>10.4.1、docker-compose文件</h5><blockquote>
<p>编写docker-compose.yml文件</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yml文件</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line"><span class="attr">services :</span></span><br><span class="line">  <span class="attr">ssm:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">build:</span>  <span class="comment">#构建自定义镜像</span></span><br><span class="line">    <span class="attr">context:</span> <span class="string">../</span>  <span class="comment">#指定dockerfile文件的所在路径</span></span><br><span class="line">    <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span> <span class="comment">#指定Dockerfile文件名称</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">ssm:1.0.1</span></span><br><span class="line">  <span class="attr">container. name:</span> <span class="string">ssm</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="number">-8081</span> <span class="string">:8080</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h5 id="10-4-2、Dockerfile文件"><a href="#10-4-2、Dockerfile文件" class="headerlink" title="10.4.2、Dockerfile文件"></a>10.4.2、Dockerfile文件</h5><blockquote>
<p>编写Dockerfile文件</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> daocloud. <span class="number">1</span>o/ library/tomcat:<span class="number">8.5</span>.<span class="number">15</span>-jre8</span><br><span class="line"><span class="keyword">copy</span><span class="bash"> ssm. war /usr/1ocal/ tomcat /webapps</span></span><br></pre></td></tr></table></figure>

<h5 id="10-4-3、运行"><a href="#10-4-3、运行" class="headerlink" title="10.4.3、运行"></a>10.4.3、运行</h5><blockquote>
<p>测试效果</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以直接启动基于docker - compose. ym1以及Dockerfile文件 构建的自定义镜像</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"><span class="comment">#如果自定义镜像不存在，会帮助我们构建出自定义镜像，如果自定义镜像已经存在，会直接运行这个自定义镜像</span></span><br><span class="line"><span class="comment">#重新构建的话。</span></span><br><span class="line"><span class="comment">#重新构建自定义镜像</span></span><br><span class="line">docker- compose build</span><br><span class="line"><span class="comment">#运行当前内容，并重新构建</span></span><br><span class="line">docker-compose up -d --build</span><br></pre></td></tr></table></figure>

<h3 id="十一、Docker-CI、CD"><a href="#十一、Docker-CI、CD" class="headerlink" title="十一、Docker CI、CD"></a>十一、Docker CI、CD</h3><hr>
<h4 id="11-1、CI、CD引言"><a href="#11-1、CI、CD引言" class="headerlink" title="11.1、CI、CD引言"></a>11.1、CI、CD引言</h4><blockquote>
<p>项目部署</p>
<ul>
<li>将项目通过maven进行编译打包</li>
<li>将文件上传到指定的服务器中</li>
<li>将war包放到tomcat的目录中</li>
<li>通过Dockerfile将Tomcat和war包转成一 个镜像，由DockerCompose去运行容器</li>
</ul>
<p>项目更新后，需要将上述流程再次的从头到尾的执行一次，如果每次更新一次都执行一-次上述操作，很费时，费力。我们就可以通过CI、CD帮助我们实现持续集成，持续交付和部署。</p>
</blockquote>
<h4 id="11-2、CI介绍"><a href="#11-2、CI介绍" class="headerlink" title="11.2、CI介绍"></a>11.2、CI介绍</h4><blockquote>
<p>CI (continuous intergration)    持续集成</p>
<p>持续集成:    编写代码时，完成了一个功能后，立即提交代码到Git仓库中，将项目重新的构建并且测试。</p>
<ul>
<li>快速发现错误。</li>
<li>防止代码偏离主分支。</li>
</ul>
</blockquote>
<h4 id="11-3、搭建Gitlab服务器"><a href="#11-3、搭建Gitlab服务器" class="headerlink" title="11.3、搭建Gitlab服务器"></a>11.3、搭建Gitlab服务器</h4><blockquote>
<p>实现CI，需要使用到Gitlab远程仓库，先通过Docker搭建Gitlab</p>
</blockquote>
<h5 id="11-3-1、准备工作"><a href="#11-3-1、准备工作" class="headerlink" title="11.3.1、准备工作"></a>11.3.1、准备工作</h5><blockquote>
<ul>
<li>创建一个全新的虚拟机，并且至少指定4G的运行内存，4G运行内存是Gitlab推荐的内存大小。</li>
<li>并且安装Docker以及Docker-Compose</li>
</ul>
</blockquote>
<h5 id="11-3-2、修改ssh的22端口"><a href="#11-3-2、修改ssh的22端口" class="headerlink" title="11.3.2、修改ssh的22端口"></a>11.3.2、修改ssh的22端口</h5><blockquote>
<p>将ssh的默认22端口，修改为60022端口， 因为Gitlab需要 占用22端口</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">vi</span> <span class="string">/etc/ssh/</span> <span class="string">sshd.</span> <span class="string">config</span></span><br><span class="line">    <span class="string">PORT</span> <span class="number">22</span> <span class="string">-&gt;</span> <span class="number">60022</span></span><br><span class="line"><span class="string">systemctl</span> <span class="string">restart</span> <span class="string">sshd</span></span><br></pre></td></tr></table></figure>

<h5 id="11-3-3、编写docker-compose-yml"><a href="#11-3-3、编写docker-compose-yml" class="headerlink" title="11.3.3、编写docker-compose.yml"></a>11.3.3、编写docker-compose.yml</h5><blockquote>
<p>docker-compose.yml文件去安装gitlab (下载和运行的时间比较长的)</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">gitlab:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&#x27; twang2218/gitlab-ce-zh:11.1.4&#x27;</span></span><br><span class="line">    <span class="attr">container name:</span> <span class="string">”g1tlab&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">&#x27; gitlab&#x27;</span></span><br><span class="line">    <span class="attr">environment :</span></span><br><span class="line">      <span class="string">TZ:‘</span> <span class="string">Asia/Shanghai&#x27;</span></span><br><span class="line">      <span class="string">GITLAB</span> <span class="string">OMNIBUS.</span> <span class="string">CONFIG:1</span></span><br><span class="line">        <span class="string">external_</span> <span class="string">url</span> <span class="string">&#x27;http://192.168.199.110 &#x27;</span></span><br><span class="line">        <span class="string">gitlab_</span> <span class="string">rails[&#x27;time.</span> <span class="string">zone&#x27;]</span> <span class="string">=</span> <span class="string">&quot; Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">        gitlab_ rails[&#x27;smtp- enable&#x27;] = true</span></span><br><span class="line"><span class="string">        gitlab_ rails[&#x27;gitlab_ shell_ ssh_port&#x27;] = 22</span></span><br><span class="line"><span class="string">    ports:</span></span><br><span class="line"><span class="string">      -&#x27;80:80&#x27;</span></span><br><span class="line"><span class="string">      -&#x27;443:443&#x27;</span></span><br><span class="line"><span class="string">      -&#x27;22:22&#x27;</span></span><br><span class="line"><span class="string">    volumes:</span></span><br><span class="line"><span class="string">      -/opt/docker. gitlab/config:/etc/gitlab</span></span><br><span class="line"><span class="string">      -/opt/docker_gitlab/data: /var /opt/gitlab</span></span><br><span class="line"><span class="string">      -/opt/docker _git1ab/1ogs :/var /1og/gitlab </span></span><br></pre></td></tr></table></figure>

<h4 id="11-4、搭建GitlabRunner"><a href="#11-4、搭建GitlabRunner" class="headerlink" title="11.4、搭建GitlabRunner"></a>11.4、搭建GitlabRunner</h4><blockquote>
<p>查看资料中的gitlab-runner文件安装即可</p>
</blockquote>
<h4 id="11-5、整合项目入门测试"><a href="#11-5、整合项目入门测试" class="headerlink" title="11.5、整合项目入门测试"></a>11.5、整合项目入门测试</h4><h5 id="11-5-1、创建项目"><a href="#11-5-1、创建项目" class="headerlink" title="11.5.1、创建项目"></a>11.5.1、创建项目</h5><blockquote>
<p>创建maven工程，添加web.xml文件，编写html文件</p>
</blockquote>
<h5 id="11-5-2、编写-gitlab-ci-yml"><a href="#11-5-2、编写-gitlab-ci-yml" class="headerlink" title="11.5.2、编写.gitlab-ci.yml"></a>11.5.2、编写.gitlab-ci.yml</h5><blockquote>
<p>编写<a href="">.gitlab-ci.yml</a>文件</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="string">-test</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="string">-echo</span> <span class="string">first</span> <span class="string">test</span> <span class="string">ci</span>  <span class="comment">#输入的命令</span></span><br></pre></td></tr></table></figure>

<h5 id="11-5-3、将maven工程推送到gitlab中"><a href="#11-5-3、将maven工程推送到gitlab中" class="headerlink" title="11.5.3、将maven工程推送到gitlab中"></a>11.5.3、将maven工程推送到gitlab中</h5><blockquote>
<p>执行git命令推送到gitlab</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<h5 id="11-5-4、查看效果"><a href="#11-5-4、查看效果" class="headerlink" title="11.5.4、查看效果"></a>11.5.4、查看效果</h5><blockquote>
<p>可以在gitlab中查看到gitlab-ci.yml编写的内容</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">效果图</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711160442166.png" alt="image-20200711160442166"></td>
</tr>
</tbody></table>
<h4 id="11-6、完善项目配置"><a href="#11-6、完善项目配置" class="headerlink" title="11.6、完善项目配置"></a>11.6、完善项目配置</h4><blockquote>
<p>添加Dockerfile以及docker- compose.yml,并修改 .gitlab-ci.yml文件</p>
</blockquote>
<h5 id="11-6-1、创建Dockerfile"><a href="#11-6-1、创建Dockerfile" class="headerlink" title="11.6.1、创建Dockerfile"></a>11.6.1、创建Dockerfile</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dockerfile</span></span><br><span class="line"><span class="keyword">FROM</span> daocloud .<span class="number">1</span>o/library/ tomcat:<span class="number">8.5</span>.<span class="number">15</span>-jre8</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> testci . war /usr /1ocal/ tomcat/ webapps</span></span><br></pre></td></tr></table></figure>

<h5 id="11-6-2、创建docker-compose-yml"><a href="#11-6-2、创建docker-compose-yml" class="headerlink" title="11.6.2、创建docker-compose.yml"></a>11.6.2、创建docker-compose.yml</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker- compose.yml</span></span><br><span class="line"><span class="string">version:“3.1&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">testci:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">docker</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container . name:</span> <span class="string">testci</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="number">-8080</span> <span class="string">:8080</span></span><br></pre></td></tr></table></figure>

<h5 id="11-6-3、修改-gitlab-ci-yml"><a href="#11-6-3、修改-gitlab-ci-yml" class="headerlink" title="11.6.3、修改.gitlab-ci.yml"></a>11.6.3、修改.gitlab-ci.yml</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ci.yml</span></span><br><span class="line"><span class="attr">stages :</span></span><br><span class="line">  <span class="string">-test</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="string">-echo</span> <span class="string">first</span> <span class="string">test</span> <span class="string">ci</span></span><br><span class="line">    <span class="string">-/usr</span> <span class="string">/local/maven/</span> <span class="string">apache</span> <span class="string">-maven-3.6.3/bin/mvn</span> <span class="string">package</span></span><br><span class="line">    <span class="string">-cp</span> <span class="string">target/testci-1.0-SNAPSHOT</span> <span class="string">.</span> <span class="string">war</span> <span class="string">docker</span> <span class="string">/</span> <span class="string">testci</span> <span class="string">.war</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker-compose</span> <span class="string">down</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker-compose</span> <span class="string">up</span> <span class="string">-d</span> <span class="string">--build</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">rmi</span> <span class="string">$(</span> <span class="string">docker</span> <span class="string">images</span> <span class="string">-qf</span> <span class="string">dangling=true)</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h5 id="11-6-4、测试"><a href="#11-6-4、测试" class="headerlink" title="11.6.4、测试"></a>11.6.4、测试</h5><table>
<thead>
<tr>
<th align="center">测试效果</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711163539401.png" alt="image-20200711163539401"></td>
</tr>
</tbody></table>
<h4 id="11-7、CD介绍"><a href="#11-7、CD介绍" class="headerlink" title="11.7、CD介绍"></a>11.7、CD介绍</h4><blockquote>
<p>CD（持续交付，持续部署）</p>
<p>持续交付:将代码交付给专业的测试团队去测试</p>
<p>持续部署:可以直接将指定好tag的代码直接部署到生产环境中</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">CICD图</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711164531752.png" alt="image-20200711164531752"></td>
</tr>
</tbody></table>
<h4 id="11-8、安装JenKins"><a href="#11-8、安装JenKins" class="headerlink" title="11.8、安装JenKins"></a>11.8、安装JenKins</h4><h5 id="11-8-1、编写docker-compose-yml"><a href="#11-8-1、编写docker-compose-yml" class="headerlink" title="11.8.1、编写docker-compose.yml"></a>11.8.1、编写docker-compose.yml</h5><blockquote>
<p>官网：<a target="_blank" rel="noopener" href="https://www.jenkins.io/">https://www.jenkins.io/</a></p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711165549352.png" alt="image-20200711165549352"></p>
<h5 id="11-8-2、运行并访问Jenkins"><a href="#11-8-2、运行并访问Jenkins" class="headerlink" title="11.8.2、运行并访问Jenkins"></a>11.8.2、运行并访问Jenkins</h5><blockquote>
<p>第一次运行时，会因为data目录没有权限，导致启动失败</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chomd 777 data</span><br></pre></td></tr></table></figure>

<blockquote>
<p>访问<a target="_blank" rel="noopener" href="http://192.168.199.109:8888/">http://192.168.199.109:8888</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">访问速度奇慢无比。。。。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>访问成功后，需要输入密码，可在日志中查看</p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711165830127.png" alt="image-20200711165830127"></p>
<blockquote>
<p>手动指定插件安装：指定下面两个插件即可</p>
<p>publish ssh.</p>
<p>git param</p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711165932238.png" alt="image-20200711165932238"></p>
<blockquote>
<p>安装成功后，需要指定用户名和密码，登陆成功</p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711170018299.png" alt="image-20200711170018299"></p>
<h4 id="11-9、配置Jenkins的目标服务器"><a href="#11-9、配置Jenkins的目标服务器" class="headerlink" title="11.9、配置Jenkins的目标服务器"></a>11.9、配置Jenkins的目标服务器</h4><blockquote>
<p>执行过程为代码提交到Gitlab, Jenkins会 从Gitlab中拉取代码，并在Jenkins中打包并发布到目标服务器中。</p>
</blockquote>
<h5 id="11-9-1、点击左侧的系统设置"><a href="#11-9-1、点击左侧的系统设置" class="headerlink" title="11.9.1、点击左侧的系统设置"></a>11.9.1、点击左侧的系统设置</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711170218506.png" alt="image-20200711170218506"></p>
<h5 id="11-9-2、选择中间区域的系统设置"><a href="#11-9-2、选择中间区域的系统设置" class="headerlink" title="11.9.2、选择中间区域的系统设置"></a>11.9.2、选择中间区域的系统设置</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711170308542.png" alt="image-20200711170308542"></p>
<h5 id="11-9-3、搜索Publish-over-SSH"><a href="#11-9-3、搜索Publish-over-SSH" class="headerlink" title="11.9.3、搜索Publish over SSH"></a>11.9.3、搜索Publish over SSH</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711170643439.png" alt="image-20200711170643439"></p>
<h5 id="11-9-4、点击上图新增"><a href="#11-9-4、点击上图新增" class="headerlink" title="11.9.4、点击上图新增"></a>11.9.4、点击上图新增</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711170821819.png" alt="image-20200711170821819"></p>
<h4 id="11-10、配置GitLab免密码登陆"><a href="#11-10、配置GitLab免密码登陆" class="headerlink" title="11.10、配置GitLab免密码登陆"></a>11.10、配置GitLab免密码登陆</h4><blockquote>
<p>链接Gitlab需要使用密码，我们可以通过SSH的方式，免密码登陆Gitlab拉取代码，避免每次都输入密码。</p>
</blockquote>
<h5 id="11-10-1、登陆JenKins容器内部"><a href="#11-10-1、登陆JenKins容器内部" class="headerlink" title="11.10.1、登陆JenKins容器内部"></a>11.10.1、登陆JenKins容器内部</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it jenkins bash</span><br></pre></td></tr></table></figure>

<h5 id="11-10-2、输入生成SSH密匙命令"><a href="#11-10-2、输入生成SSH密匙命令" class="headerlink" title="11.10.2、输入生成SSH密匙命令"></a>11.10.2、输入生成SSH密匙命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;邮箱（随便写）&quot;</span><br></pre></td></tr></table></figure>

<h5 id="11-10-3、将密匙复制到GitLab的SSH中"><a href="#11-10-3、将密匙复制到GitLab的SSH中" class="headerlink" title="11.10.3、将密匙复制到GitLab的SSH中"></a>11.10.3、将密匙复制到GitLab的SSH中</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171147001.png" alt="image-20200711171147001"></p>
<h4 id="11-11、配置JDK和Maven"><a href="#11-11、配置JDK和Maven" class="headerlink" title="11.11、配置JDK和Maven"></a>11.11、配置JDK和Maven</h4><blockquote>
<p>我们需要在Jenkins中将代码打包，需要依赖JDK和Maven环境</p>
</blockquote>
<h5 id="11-11-1、复制软件到data目录下"><a href="#11-11-1、复制软件到data目录下" class="headerlink" title="11.11.1、复制软件到data目录下"></a>11.11.1、复制软件到data目录下</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171323135.png" alt="image-20200711171323135"></p>
<h5 id="11-11-2、在监控界面中配置JDK和Maven"><a href="#11-11-2、在监控界面中配置JDK和Maven" class="headerlink" title="11.11.2、在监控界面中配置JDK和Maven"></a>11.11.2、在监控界面中配置JDK和Maven</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171400732.png" alt="image-20200711171400732"></p>
<h5 id="11-11-3、手动拉取gitlab项目"><a href="#11-11-3、手动拉取gitlab项目" class="headerlink" title="11.11.3、手动拉取gitlab项目"></a>11.11.3、手动拉取gitlab项目</h5><blockquote>
<p>使用SSH无密码连接时，第一次连接需要手动确定</p>
</blockquote>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171459669.png" alt="image-20200711171459669"></p>
<h4 id="11-12、创建Maven任务"><a href="#11-12、创建Maven任务" class="headerlink" title="11.12、创建Maven任务"></a>11.12、创建Maven任务</h4><blockquote>
<p>实现通过Jenkins的Maven任务，自动去Gitlab拉取代码，并在本地打包，发布到目标服务器上</p>
</blockquote>
<h5 id="11-12-1、创建maven工程，推送到GitLab中"><a href="#11-12-1、创建maven工程，推送到GitLab中" class="headerlink" title="11.12.1、创建maven工程，推送到GitLab中"></a>11.12.1、创建maven工程，推送到GitLab中</h5><blockquote>
<p>随便创建一个即可…. </p>
</blockquote>
<h5 id="11-12-2、-Jenkins的监控页面中创建maven任务"><a href="#11-12-2、-Jenkins的监控页面中创建maven任务" class="headerlink" title="11.12.2、 Jenkins的监控页面中创建maven任务"></a>11.12.2、 Jenkins的监控页面中创建maven任务</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171654211.png" alt="image-20200711171654211"></p>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171709493.png" alt="image-20200711171709493"></p>
<h5 id="11-12-3、执行Maven项目"><a href="#11-12-3、执行Maven项目" class="headerlink" title="11.12.3、执行Maven项目"></a>11.12.3、执行Maven项目</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171744476.png" alt="image-20200711171744476"></p>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171759918.png" alt="image-20200711171759918"></p>
<h5 id="11-12-4、最终效果"><a href="#11-12-4、最终效果" class="headerlink" title="11.12.4、最终效果"></a>11.12.4、最终效果</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711171829821.png" alt="image-20200711171829821"></p>
<h4 id="11-13、实现持续交付持续部署"><a href="#11-13、实现持续交付持续部署" class="headerlink" title="11.13、实现持续交付持续部署"></a>11.13、实现持续交付持续部署</h4><blockquote>
<p>实现根据tag标签，实现持续交付和持续部署</p>
</blockquote>
<h5 id="11-13-1、安装Persistent-Parameter"><a href="#11-13-1、安装Persistent-Parameter" class="headerlink" title="11.13.1、安装Persistent  Parameter"></a>11.13.1、安装Persistent  Parameter</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172058042.png" alt="image-20200711172058042"></p>
<h5 id="11-13-2、重新指定构建项目的方式"><a href="#11-13-2、重新指定构建项目的方式" class="headerlink" title="11.13.2、重新指定构建项目的方式"></a>11.13.2、重新指定构建项目的方式</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172228490.png" alt="image-20200711172228490"></p>
<p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172239593.png" alt="image-20200711172239593"></p>
<h5 id="11-13-3、构建项目成功后，需要将内容发布到目标服务器"><a href="#11-13-3、构建项目成功后，需要将内容发布到目标服务器" class="headerlink" title="11.13.3、构建项目成功后，需要将内容发布到目标服务器"></a>11.13.3、构建项目成功后，需要将内容发布到目标服务器</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172435074.png" alt="image-20200711172435074"></p>
<h5 id="11-13-4、添加程序代码"><a href="#11-13-4、添加程序代码" class="headerlink" title="11.13.4、添加程序代码"></a>11.13.4、添加程序代码</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172501372.png" alt="image-20200711172501372"></p>
<h5 id="11-13-5、测试"><a href="#11-13-5、测试" class="headerlink" title="11.13.5、测试"></a>11.13.5、测试</h5><p><img src="https://yankang.oss-cn-beijing.aliyuncs.com/imgs/image-20200711172522365.png" alt="image-20200711172522365"></p>

      </div>
    </div>
  </div>
</div>
<div class="lx-navigation">
	<div class="lx-cover prev lx-cover-sm" style="background-image: url(//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/images/footer-l.jpeg)">
		<div class="overlay"></div>
		<a class="copy" href="#">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Next</span>
						<h3>No newer post</h3>
					</div>
				</div>
			</div>
		</a>
	</div>
        <div class="lx-cover next lx-cover-sm" style="background-image: url(//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/images/footer-r.jpeg)">
		<div class="overlay"></div>
		<a class="copy" href="/2020/08/13/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Prev</span>
						<h3>常用工具</h3>
					</div>
				</div>
			</div>
		</a>
	</div>
</div>

</div>
<div class="comment"><div id="comments"></div></div>
<footer>
  <div>
  Copyright &copy; 2019.<a href="/">Yan's Notes</a><br>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://lx.js.org" target="_blank">Lx</a><br>
  </div>
</footer>

</div>

<button class="hamburger hamburger--arrow-r" type="button">
    <div class="hamburger-box">
      <div class="hamburger-inner"></div>
    </div>
</button> 
<div class="menu visibility">
  <div class="menu-head">
    <span class="layer">
      <div class="col">
        <div class="row for-pic">
          <div class="profile-pic">
            <a href="/"><img src="/images/avatar.jpeg" alt="Yan"/></a>
          </div>
        </div>
        <div class="row for-name">
          <p>Yan</p>
          <span class="tagline">Hello, World!</span>
        </div>
      </div>
    </span>
  </div>
  <nav class="menu-container">
  <ul class="menu-items">
    <li><a href="/"><i class="fa fa-home fa-fw"></i>Home</a></li>
    <li><a href="/archives/"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
    
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-bookmark fa-fw"></i>Pages</span>
        <ul>
          <li><a href="/guestbook/">Guestbook</a></li>
        <li><a href="/about/">About</a></li>
        </ul>
    </li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-link fa-fw"></i>Friends</span>
        <ul>
          <li> <a href="/null" target="_blank">Theme-Lx</a></li>
        </ul>
    </li>
  </ul>
  </nav>
</div>

<div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<script src="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/js/jquery.easing.min.js"></script>
<script>
(function () {
	"use strict";
	var goToTop = function() {
		$(".js-gotop").on("click", function(event){
			event.preventDefault();
			$("html, body").animate({
				scrollTop: $("html").offset().top
			}, 500, "easeInOutExpo");
			return false;
		});
		$(window).scroll(function(){
			var $win = $(window);
			if ($win.scrollTop() > 200) {
				$(".js-top").addClass("active");
			} else {
				$(".js-top").removeClass("active");
			}
		});
	};
	$(function(){
		goToTop();
	});
}());
</script>
<script src="//cdn.jsdelivr.net/npm/theme-lx@0.3.9/source/js/local.search.js"></script>
<script src="//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>
<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'fIF1fHkqD00TisI8hLBdCjf2-gzGzoHsz',
    appKey: 'VyJaF3CTrnAmPCdwbSsaTtvS',
    placeholder: 'Say something.',
    avatar: 'identicon',
    meta: guest,
    pageSize: '10' || 10,
    lang: 'en' || 'zh-cn'
  });
</script>

</body>
</html>
